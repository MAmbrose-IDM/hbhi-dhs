smc <- read.csv('bin/LGA_map_input/projection/smc_scen2_80.csv')
rm(list=ls())
setwd("C:/Users/ido0493/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#setwd("~/Box/NU-malaria-team/data/nigeria_dhs/data_analysis")
#important to download the github version of tidyverse.Uncomment the script below to run
# install.packages("devtools") #download devtools if is not available in your packages
#devtools::install_github("hadley/tidyverse")
## Reading in the necessary libraries
x <- c("tidyverse", "survey", "haven", "ggplot2", "purrr", "summarytools", "stringr", "sp", "rgdal", "raster",
"lubridate", "RColorBrewer","sf", "shinyjs", "tmap", "knitr", "labelled", "plotrix", "arules", "foreign",
"fuzzyjoin", "splitstackshape")
lapply(x, library, character.only = TRUE) #applying the library function to packages
# update.packages(oldPkgs = x)
options(survey.lonely.psu="adjust") # this option allows admin units with only one cluster to be analyzed
# require(pacman)
# p_unlock()
source("src/Nigeria functions.R")
LGAshp <- readOGR("data/Nigeria_LGAs_shapefile_191016", layer ="NGA_LGAs", use_iconv=TRUE, encoding= "UTF-8")
LGAshp_sf <- st_as_sf(LGAshp)
LGAshp_sf$LGA <- gsub("\\/", "-", LGAshp_sf$LGA)
LGA_cov <-  LGAshp_sf %>% mutate(LGA = ifelse(LGA == "kaita","Kaita", ifelse(LGA == "kiyawa", "Kiyawa", as.character(LGA))))
smc <- read.csv('bin/LGA_map_input/projection/smc_scen2_80.csv')
head(smc)
smc_split <- split(smc, smc$year)
View(smc_split)
LGA_cov_2 <- left_join(LGAshp_sf, smc_split$`2020`, by = "LGA")
head(LGA_cov_2)
summary(LGA_cov_2$coverage_low_access)
summary(LGA_cov_2$coverage_high_access)
twenty_20_low  <- tm_shape(LGA_cov_2) + #this is the health district shapfile with LLIn info
tm_polygons(col = "coverage_low_access", textNA = "No data",
title = "", palette = "seq", breaks=c(0,0.2, 0.3,
0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0))+
tm_layout(title = "2020 SMC low LGA ITN", aes.palette = list(seq="RdYlBu"))
twenty_20_low
#map
twenty_20_high  <- tm_shape(LGA_cov_2) + #this is the health district shapfile with LLIn info
tm_polygons(col = "coverage_high_access", textNA = "No data",
title = "", palette = "seq", breaks=c(0,0.2, 0.3,
0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0))+
tm_layout(title = "2020 SMC high LGA ITN", aes.palette = list(seq="RdYlBu"))
twenty_20_high
SMC_maps <- tmap_arrange(twenty_20_low,twenty_20_high)
SMC_maps
tmap_save(tm = SMC_maps, filename = "results/LGA_maps/SMC/SMC_scen2.pdf", width=13, height=13, units ="in", asp=0,
paper ="A4r", useDingbats=FALSE)
